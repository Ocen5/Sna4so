<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AppMain.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sna4so</a> &gt; <a href="index.source.html" class="el_package">it.uniba.main</a> &gt; <span class="el_source">AppMain.java</span></div><h1>AppMain.java</h1><pre class="source lang-java linenums">package it.uniba.main;

import java.io.FileNotFoundException;
import java.io.IOException;
import java.net.URISyntaxException;
import java.security.GeneralSecurityException;

import com.google.cloud.bigquery.Job;
import com.google.cloud.bigquery.TableResult;

import it.uniba.sotorrent.GoogleDocsUtils;
import it.uniba.sotorrent.ISOQuery;
import it.uniba.sotorrent.SOQueryAnswerDay;
import it.uniba.sotorrent.SOQueryAnswerTags;
import it.uniba.sotorrent.SOQueryPostDay;
import it.uniba.sotorrent.SOQueryPostTags;
import it.uniba.sotorrent.SOQueryQuestionDay;
import it.uniba.sotorrent.SOQueryQuestionTags;


/**
 * The main class for the project. It must be customized to meet the project
 * assignment specifications.
 * 
 * &lt;b&gt;DO NOT RENAME&lt;/b&gt;
 */

public final class AppMain {

	/**
	 * Valid parameters for queries.
	 * 
	 * yyyy 	The year for the WHERE clause of the query.
	 * mm 		The month for the WHERE clause of the query.
	 * dd 		The day for the WHERE clause of the query.
	 * limit 	The limit of tuples.
	 */
	private static Integer yyyy, mm, dd, limit;

	/**
	 * type 	The type to choose the query.
	 * taglike 	The argument of posts for the WHERE clause of the query.
	 */
	private static String type, taglike;


	/**
	 * Private constructor. Init varibles from args input.
	 * 
	 * @param args The command-line arguments.
	 * 
	 * @throws IllegalArgumentException See stack trace for proper location.
	 */
<span class="nc" id="L54">	private AppMain(final String[] args)  throws IllegalArgumentException {</span>

<span class="nc bnc" id="L56" title="All 2 branches missed.">		for (int i = 0; i &lt; args.length; i++) {</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">			if (args[i].contains(&quot;yyyy=&quot;)) {</span>
<span class="nc" id="L58">				yyyy = Integer.valueOf(args[i].substring(5));</span>
			} else {
<span class="nc bnc" id="L60" title="All 2 branches missed.">				if (args[i].contains(&quot;mm=&quot;)) {</span>
<span class="nc" id="L61">					mm = Integer.valueOf(args[i].substring(3));</span>
				} else {
<span class="nc bnc" id="L63" title="All 2 branches missed.">					if (args[i].contains(&quot;dd=&quot;)) {</span>
<span class="nc" id="L64">						dd = Integer.valueOf(args[i].substring(3));</span>
					} else {
<span class="nc bnc" id="L66" title="All 2 branches missed.">						if (args[i].contains(&quot;taglike=&quot;)) {</span>
<span class="nc" id="L67">							taglike = args[i].substring(8);</span>
						} else {
<span class="nc bnc" id="L69" title="All 2 branches missed.">							if (args[i].contains(&quot;limit=&quot;)) {</span>
<span class="nc" id="L70">								limit = Integer.valueOf(args[i].substring(6));</span>
							} else {
<span class="nc bnc" id="L72" title="All 2 branches missed.">								if (args[i].contains(&quot;type=&quot;)) {</span>
<span class="nc" id="L73">									type = args[i].substring(5);</span>
								} else {
<span class="nc" id="L75">									IllegalArgumentException exception = new IllegalArgumentException(</span>
											&quot;Parametro di input non valido.&quot;);
<span class="nc" id="L77">									throw exception;</span>
								}
							}
						}
					}
				}
			}
		}

<span class="nc" id="L86">	}</span>


	/**
	 * 	 * This is the main entry of the application.
	 *
	 * @param args The command-line arguments.
	 * 
	 * @throws FileNotFoundException See stack trace for proper location.
	 * @throws IOException  See stack trace for proper location.
	 * @throws InterruptedException  See stack trace for proper location.
	 * @throws GeneralSecurityException  See stack trace for proper location.
	 * @throws URISyntaxException  See stack trace for proper location.
	 * @throws IllegalArgumentException See stack trace for proper location.
	 */

	public static void main(final String[] args) throws FileNotFoundException,
	IOException,
	InterruptedException,
	GeneralSecurityException,
	URISyntaxException,
	IllegalArgumentException {
<span class="nc" id="L108">		System.out.println(&quot;Current working dir: &quot; + System.getProperty(&quot;user.dir&quot;));</span>

		//Take valid values from args, see AppMain constructor for further information.
<span class="nc" id="L111">		new AppMain(args);</span>


<span class="nc" id="L114">		ISOQuery soq = null;</span>
<span class="nc" id="L115">		String nameQuery = new String();</span>

		//choose the query type and run the query
<span class="nc bnc" id="L118" title="All 4 branches missed.">		switch (type) {</span>
		case &quot;question&quot; :

<span class="nc bnc" id="L121" title="All 4 branches missed.">			if (dd != null &amp;&amp; taglike == null) {           //Query con DAY</span>
<span class="nc" id="L122">				nameQuery = new String(&quot;Seleziona i primi &quot;</span>
						+ limit
						+ &quot; id utente che hanno fatto almeno una domanda il &quot;
						+ yyyy + &quot;/&quot; + mm + &quot;/&quot; + dd);
<span class="nc" id="L126">				System.out.println(nameQuery);</span>
<span class="nc" id="L127">				soq = new SOQueryQuestionDay(yyyy, mm, dd, limit);</span>
<span class="nc" id="L128">				break;</span>
			}
<span class="nc bnc" id="L130" title="All 4 branches missed.">			if (dd == null &amp;&amp; taglike != null) {          //Query con TAGLIKE</span>
<span class="nc" id="L131">				nameQuery = new String(&quot;Seleziona i primi &quot;</span>
						+ limit
						+ &quot; id utente che hanno fatto almeno una domanda sull' argomento &quot;
						+ taglike + &quot; il &quot; + yyyy + &quot;/&quot; + mm);
<span class="nc" id="L135">				System.out.println(nameQuery);</span>
<span class="nc" id="L136">				soq = new SOQueryQuestionTags(yyyy, mm, taglike, limit);</span>
<span class="nc" id="L137">				break;</span>
			} else {
<span class="nc" id="L139">				IllegalArgumentException valuesException = new IllegalArgumentException(</span>
						&quot;Argomenti non validi.&quot;);
<span class="nc" id="L141">				throw valuesException;</span>
			}

		case &quot;answer&quot; :

<span class="nc bnc" id="L146" title="All 4 branches missed.">			if (dd != null &amp;&amp; taglike == null) {           //Query con DAY</span>
<span class="nc" id="L147">				nameQuery = new String(&quot;Seleziona i primi &quot;</span>
						+ limit
						+ &quot;id utente che hanno dato almeno una risposta il &quot;
						+ yyyy + &quot;/&quot; + mm + &quot;/&quot; + dd);
<span class="nc" id="L151">				System.out.println(nameQuery);</span>
<span class="nc" id="L152">				soq = new SOQueryAnswerDay(yyyy, mm, dd, limit);</span>
<span class="nc" id="L153">				break;</span>
			}
<span class="nc bnc" id="L155" title="All 4 branches missed.">			if (dd == null &amp;&amp; taglike != null) {          //Query con TAGLIKE</span>
<span class="nc" id="L156">				nameQuery = new String(&quot;Seleziona i primi &quot;</span>
						+ limit
						+ &quot; id utente che hanno dato almeno una risposta sull' argomento &quot;
						+ taglike + &quot; il &quot; + yyyy + &quot;/&quot; + mm);
<span class="nc" id="L160">				System.out.println(nameQuery);</span>
<span class="nc" id="L161">				soq = new SOQueryAnswerTags(yyyy, mm, taglike, limit);</span>
<span class="nc" id="L162">				break;</span>
			} else {
<span class="nc" id="L164">				IllegalArgumentException valuesException = new IllegalArgumentException(</span>
						&quot;Argomenti non validi.&quot;);
<span class="nc" id="L166">				throw valuesException;</span>
			}

		case &quot;post&quot; :

<span class="nc bnc" id="L171" title="All 4 branches missed.">			if (dd != null &amp;&amp; taglike == null) {           //Query con DAY</span>
<span class="nc" id="L172">				nameQuery = new String(&quot;Seleziona i primi &quot;</span>
						+ limit
						+ &quot;id utente che hanno fatto almeno un post il &quot;
						+ yyyy + &quot;/&quot; + mm + &quot;/&quot; + dd);
<span class="nc" id="L176">				System.out.println(nameQuery);</span>
<span class="nc" id="L177">				soq = new SOQueryPostDay(yyyy, mm, dd, limit);</span>
<span class="nc" id="L178">				break;</span>
			}
<span class="nc bnc" id="L180" title="All 4 branches missed.">			if (dd == null &amp;&amp; taglike != null) {          //Query con TAGLIKE</span>
<span class="nc" id="L181">				nameQuery = new String(&quot;Seleziona i primi &quot;</span>
						+ limit
						+ &quot; id utente che hanno fatto almeno un post sull' argomento &quot;
						+ taglike + &quot; il &quot; + yyyy + &quot;/&quot; + mm);
<span class="nc" id="L185">				System.out.println(nameQuery);</span>
<span class="nc" id="L186">				soq = new SOQueryPostTags(yyyy, mm, taglike, limit);</span>
<span class="nc" id="L187">				break;</span>
			} else {
<span class="nc" id="L189">				IllegalArgumentException valuesException = new IllegalArgumentException(</span>
						&quot;Argomenti non validi.&quot;);
<span class="nc" id="L191">				throw valuesException;</span>
			}

		default :

<span class="nc" id="L196">			IllegalArgumentException typeException = new IllegalArgumentException(</span>
					&quot;Type query non valido.&quot;);
<span class="nc" id="L198">			throw typeException;</span>

		}


<span class="nc" id="L203">		Job job = soq.runQuery();</span>
<span class="nc" id="L204">		TableResult res = soq.getResults(job);</span>

<span class="nc" id="L206">		GoogleDocsUtils ut = new GoogleDocsUtils();</span>
<span class="nc" id="L207">		String spid = ut.createSheet(&quot;SNA4SO - &quot; + nameQuery);</span>
<span class="nc" id="L208">		ut.shareSheet(spid);</span>
<span class="nc" id="L209">		ut.getSheetByTitle(spid);</span>
<span class="nc" id="L210">		ut.writeSheet(spid, res);</span>

<span class="nc" id="L212">	}</span>


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>